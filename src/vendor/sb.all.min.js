(function(){function t(t){return V(t)&&ft.call(t,"callee")&&!vt.call(t,"callee")}function n(t,n){return t.push.apply(t,n),t}function e(t){return function(n){return null==n?tt:n[t]}}function r(t,n,e,r,i){return i(t,function(t,i,o){e=r?(r=!1,t):n(e,t,i,o)}),e}function i(t,n){return g(n,function(n){return t[n]})}function o(t){return t instanceof u?t:new u(t)}function u(t,n){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!n}function a(t,n,e){if("function"!=typeof t)throw new TypeError("Expected a function");return setTimeout(function(){t.apply(tt,e)},n)}function c(t,n){var e=!0;return bt(t,function(t,r,i){return e=!!n(t,r,i)}),e}function s(t,n,e){for(var r=-1,i=t.length;++r<i;){var o=t[r],u=n(o);if(null!=u&&(a===tt?u===u:e(u,a)))var a=u,c=o}return c}function f(t,n){var e=[];return bt(t,function(t,r,i){n(t,r,i)&&e.push(t)}),e}function l(t,e,r,i,o){var u=-1,a=t.length;for(r||(r=R),o||(o=[]);++u<a;){var c=t[u];0<e&&r(c)?1<e?l(c,e-1,r,i,o):n(o,c):i||(o[o.length]=c)}return o}function p(t,n){return t&&wt(t,n,Rt)}function h(t,n){return f(n,function(n){return Z(t[n])})}function d(t,n){return t>n}function v(t,n,e,r,i){return t===n||(null==t||null==n||!V(t)&&!V(n)?t!==t&&n!==n:y(t,n,e,r,v,i))}function y(t,n,e,r,i,o){var u=Tt(t),a=Tt(n),c=u?"[object Array]":pt.call(t),s=a?"[object Array]":pt.call(n),c="[object Arguments]"==c?"[object Object]":c,s="[object Arguments]"==s?"[object Object]":s,f="[object Object]"==c,a="[object Object]"==s,s=c==s;o||(o=[]);var l=jt(o,function(n){return n[0]==t}),p=jt(o,function(t){return t[0]==n});if(l&&p)return l[1]==n;if(o.push([t,n]),o.push([n,t]),s&&!f){if(u)e=F(t,n,e,r,i,o);else t:{switch(c){case"[object Boolean]":case"[object Date]":case"[object Number]":e=U(+t,+n);break t;case"[object Error]":e=t.name==n.name&&t.message==n.message;break t;case"[object RegExp]":case"[object String]":e=t==n+"";break t}e=!1}return o.pop(),e}return 1&e||(u=f&&ft.call(t,"__wrapped__"),c=a&&ft.call(n,"__wrapped__"),!u&&!c)?!!s&&(e=P(t,n,e,r,i,o),o.pop(),e):(u=u?t.value():t,c=c?n.value():n,e=i(u,c,e,r,o),o.pop(),e)}function m(t){return"function"==typeof t?t:null==t?X:("object"==typeof t?b:e)(t)}function _(t,n){return t<n}function g(t,n){var e=-1,r=$(t)?Array(t.length):[];return bt(t,function(t,i,o){r[++e]=n(t,i,o)}),r}function b(t){var n=mt(t);return function(e){var r=n.length;if(null==e)return!r;for(e=Object(e);r--;){var i=n[r];if(!(i in e&&v(t[i],e[i],3)))return!1}return!0}}function w(t,n){return t=Object(t),B(n,function(n,e){return e in t&&(n[e]=t[e]),n},{})}function k(t){return kt(M(t,void 0,X),t+"")}function j(t,n,e){var r=-1,i=t.length;for(0>n&&(n=-n>i?0:i+n),e=e>i?i:e,0>e&&(e+=i),i=n>e?0:e-n>>>0,n>>>=0,e=Array(i);++r<i;)e[r]=t[r+n];return e}function x(t){return j(t,0,t.length)}function E(t,n){var e;return bt(t,function(t,r,i){return e=n(t,r,i),!e}),!!e}function S(t,e){return B(e,function(t,e){return e.func.apply(e.thisArg,n([t],e.args))},t)}function T(t,n,e,r){var i=!e;e||(e={});for(var o=-1,u=n.length;++o<u;){var a=n[o],c=r?r(e[a],t[a],a,e,t):tt;if(c===tt&&(c=t[a]),i)e[a]=c;else{var s=e,f=s[a];ft.call(s,a)&&U(f,c)&&(c!==tt||a in s)||(s[a]=c)}}return e}function O(t){return k(function(n,e){var r=-1,i=e.length,o=1<i?e[i-1]:tt,o=3<t.length&&"function"==typeof o?(i--,o):tt;for(n=Object(n);++r<i;){var u=e[r];u&&t(n,u,r,o)}return n})}function A(t){return function(){var n=arguments,e=gt(t.prototype),n=t.apply(e,n);return K(n)?n:e}}function D(t,n,e){function r(){for(var o=-1,u=arguments.length,a=-1,c=e.length,s=Array(c+u),f=this&&this!==ot&&this instanceof r?i:t;++a<c;)s[a]=e[a];for(;u--;)s[a++]=arguments[++o];return f.apply(n,s)}if("function"!=typeof t)throw new TypeError("Expected a function");var i=A(t);return r}function C(t,n,e,r){return t===tt||U(t,st[e])&&!ft.call(r,e)?n:t}function F(t,n,e,r,i,o){var u=t.length,a=n.length;if(u!=a&&!(1&e&&a>u))return!1;for(var a=-1,c=!0,s=2&e?[]:tt;++a<u;){var f=t[a],l=n[a];if(void 0!==tt){c=!1;break}if(s){if(!E(n,function(t,n){if(!q(s,n)&&(f===t||i(f,t,e,r,o)))return s.push(n)})){c=!1;break}}else if(f!==l&&!i(f,l,e,r,o)){c=!1;break}}return c}function P(t,n,e,r,i,o){var u=1&e,a=Rt(t),c=a.length,s=Rt(n).length;if(c!=s&&!u)return!1;for(var f=c;f--;){var l=a[f];if(!(u?l in n:ft.call(n,l)))return!1}for(s=!0;++f<c;){var l=a[f],p=t[l],h=n[l];if(void 0!==tt||p!==h&&!i(p,h,e,r,o)){s=!1;break}u||(u="constructor"==l)}return s&&!u&&(e=t.constructor,r=n.constructor,e!=r&&"constructor"in t&&"constructor"in n&&!("function"==typeof e&&e instanceof e&&"function"==typeof r&&r instanceof r)&&(s=!1)),s}function R(n){return Tt(n)||t(n)}function I(t){var n=[];if(null!=t)for(var e in Object(t))n.push(e);return n}function M(t,n,e){return n=_t(n===tt?t.length-1:n,0),function(){for(var r=arguments,i=-1,o=_t(r.length-n,0),u=Array(o);++i<o;)u[i]=r[n+i];for(i=-1,o=Array(n+1);++i<n;)o[i]=r[i];return o[n]=e(u),t.apply(this,o)}}function N(t){return(null==t?0:t.length)?l(t,1):[]}function Q(t){return t&&t.length?t[0]:tt}function q(t,n,e){var r=null==t?0:t.length;e="number"==typeof e?0>e?_t(r+e,0):e:0,e=(e||0)-1;for(var i=n===n;++e<r;){var o=t[e];if(i?o===n:o!==o)return e}return-1}function L(t,n){return bt(t,m(n))}function B(t,n,e){return r(t,m(n),e,3>arguments.length,bt)}function z(t,n){var e;if("function"!=typeof n)throw new TypeError("Expected a function");return t=Ot(t),function(){return 0<--t&&(e=n.apply(this,arguments)),1>=t&&(n=tt),e}}function U(t,n){return t===n||t!==t&&n!==n}function $(t){var n;return(n=null!=t)&&(n=t.length,n="number"==typeof n&&-1<n&&0==n%1&&9007199254740991>=n),n&&!Z(t)}function Z(t){return!!K(t)&&(t=pt.call(t),"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t)}function K(t){var n=typeof t;return null!=t&&("object"==n||"function"==n)}function V(t){return null!=t&&"object"==typeof t}function G(t){return"number"==typeof t||V(t)&&"[object Number]"==pt.call(t)}function H(t){return"string"==typeof t||!Tt(t)&&V(t)&&"[object String]"==pt.call(t)}function J(t){return"string"==typeof t?t:null==t?"":t+""}function W(t){return null==t?[]:i(t,Rt(t))}function X(t){return t}function Y(t,e,r){var i=Rt(e),o=h(e,i);null!=r||K(e)&&(o.length||!i.length)||(r=e,e=t,t=this,o=h(e,Rt(e)));var u=!(K(r)&&"chain"in r&&!r.chain),a=Z(t);return bt(o,function(r){var i=e[r];t[r]=i,a&&(t.prototype[r]=function(){var e=this.__chain__;if(u||e){var r=t(this.__wrapped__);return(r.__actions__=x(this.__actions__)).push({func:i,args:arguments,thisArg:t}),r.__chain__=e,r}return i.apply(t,n([this.value()],arguments))})}),t}var tt,nt=1/0,et=/[&<>"']/g,rt=RegExp(et.source),it="object"==typeof self&&self&&self.Object===Object&&self,ot="object"==typeof global&&global&&global.Object===Object&&global||it||Function("return this")(),ut=(it="object"==typeof exports&&exports&&!exports.nodeType&&exports)&&"object"==typeof module&&module&&!module.nodeType&&module,at=function(t){return function(n){return null==t?tt:t[n]}}({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}),ct=Array.prototype,st=Object.prototype,ft=st.hasOwnProperty,lt=0,pt=st.toString,ht=ot._,dt=Object.create,vt=st.propertyIsEnumerable,yt=ot.isFinite,mt=function(t,n){return function(e){return t(n(e))}}(Object.keys,Object),_t=Math.max,gt=function(){function t(){}return function(n){return K(n)?dt?dt(n):(t.prototype=n,n=new t,t.prototype=tt,n):{}}}();u.prototype=gt(o.prototype),u.prototype.constructor=u;var bt=function(t,n){return function(e,r){if(null==e)return e;if(!$(e))return t(e,r);for(var i=e.length,o=n?i:-1,u=Object(e);(n?o--:++o<i)&&!1!==r(u[o],o,u););return e}}(p),wt=function(t){return function(n,e,r){var i=-1,o=Object(n);r=r(n);for(var u=r.length;u--;){var a=r[t?u:++i];if(!1===e(o[a],a,o))break}return n}}(),kt=X,jt=function(t){return function(n,e,r){var i=Object(n);if(!$(n)){var o=m(e);n=Rt(n),e=function(t){return o(i[t],t,i)}}return e=t(n,e,r),-1<e?i[o?n[e]:e]:tt}}(function(t,n,e){var r=null==t?0:t.length;if(!r)return-1;e=null==e?0:Ot(e),0>e&&(e=_t(r+e,0));t:{for(n=m(n),r=t.length,e+=-1;++e<r;)if(n(t[e],e,t)){t=e;break t}t=-1}return t}),xt=k(function(t,n,e){return D(t,n,e)}),Et=k(function(t,n){return a(t,1,n)}),St=k(function(t,n,e){return a(t,At(n)||0,e)}),Tt=Array.isArray,Ot=Number,At=Number,Dt=O(function(t,n){T(n,mt(n),t)}),Ct=O(function(t,n){T(n,I(n),t)}),Ft=O(function(t,n,e,r){T(n,It(n),t,r)}),Pt=k(function(t){return t.push(tt,C),Ft.apply(tt,t)}),Rt=mt,It=I,Mt=function(t){return kt(M(t,tt,N),t+"")}(function(t,n){return null==t?{}:w(t,n)});o.assignIn=Ct,o.before=z,o.bind=xt,o.chain=function(t){return t=o(t),t.__chain__=!0,t},o.compact=function(t){return f(t,Boolean)},o.concat=function(){var t=arguments.length;if(!t)return[];for(var e=Array(t-1),r=arguments[0];t--;)e[t-1]=arguments[t];return n(Tt(r)?x(r):[r],l(e,1))},o.create=function(t,n){var e=gt(t);return null==n?e:Dt(e,n)},o.defaults=Pt,o.defer=Et,o.delay=St,o.filter=function(t,n){return f(t,m(n))},o.flatten=N,o.flattenDeep=function(t){return(null==t?0:t.length)?l(t,nt):[]},o.iteratee=m,o.keys=Rt,o.map=function(t,n){return g(t,m(n))},o.matches=function(t){return b(Dt({},t))},o.mixin=Y,o.negate=function(t){if("function"!=typeof t)throw new TypeError("Expected a function");return function(){return!t.apply(this,arguments)}},o.once=function(t){return z(2,t)},o.pick=Mt,o.slice=function(t,n,e){var r=null==t?0:t.length;return e=e===tt?r:+e,r?j(t,null==n?0:+n,e):[]},o.sortBy=function(t,n){var r=0;return n=m(n),g(g(t,function(t,e,i){return{value:t,index:r++,criteria:n(t,e,i)}}).sort(function(t,n){var e;t:{e=t.criteria;var r=n.criteria;if(e!==r){var i=e!==tt,o=null===e,u=e===e,a=r!==tt,c=null===r,s=r===r;if(!c&&e>r||o&&a&&s||!i&&s||!u){e=1;break t}if(!o&&e<r||c&&i&&u||!a&&u||!s){e=-1;break t}}e=0}return e||t.index-n.index}),e("value"))},o.tap=function(t,n){return n(t),t},o.thru=function(t,n){return n(t)},o.toArray=function(t){return $(t)?t.length?x(t):[]:W(t)},o.values=W,o.extend=Ct,Y(o,o),o.clone=function(t){return K(t)?Tt(t)?x(t):T(t,mt(t)):t},o.escape=function(t){return(t=J(t))&&rt.test(t)?t.replace(et,at):t},o.every=function(t,n,e){return n=e?tt:n,c(t,m(n))},o.find=jt,o.forEach=L,o.has=function(t,n){return null!=t&&ft.call(t,n)},o.head=Q,o.identity=X,o.indexOf=q,o.isArguments=t,o.isArray=Tt,o.isBoolean=function(t){return!0===t||!1===t||V(t)&&"[object Boolean]"==pt.call(t)},o.isDate=function(t){return V(t)&&"[object Date]"==pt.call(t)},o.isEmpty=function(n){return $(n)&&(Tt(n)||H(n)||Z(n.splice)||t(n))?!n.length:!mt(n).length},o.isEqual=function(t,n){return v(t,n)},o.isFinite=function(t){return"number"==typeof t&&yt(t)},o.isFunction=Z,o.isNaN=function(t){return G(t)&&t!=+t},o.isNull=function(t){return null===t},o.isNumber=G,o.isObject=K,o.isRegExp=function(t){return V(t)&&"[object RegExp]"==pt.call(t)},o.isString=H,o.isUndefined=function(t){return t===tt},o.last=function(t){var n=null==t?0:t.length;return n?t[n-1]:tt},o.max=function(t){return t&&t.length?s(t,X,d):tt},o.min=function(t){return t&&t.length?s(t,X,_):tt},o.noConflict=function(){return ot._===this&&(ot._=ht),this},o.noop=function(){},o.reduce=B,o.result=function(t,n,e){return n=null==t?tt:t[n],n===tt&&(n=e),Z(n)?n.call(t):n},o.size=function(t){return null==t?0:(t=$(t)?t:mt(t),t.length)},o.some=function(t,n,e){return n=e?tt:n,E(t,m(n))},o.uniqueId=function(t){var n=++lt;return J(t)+n},o.each=L,o.first=Q,Y(o,function(){var t={};return p(o,function(n,e){ft.call(o.prototype,e)||(t[e]=n)}),t}(),{chain:!1}),o.VERSION="4.17.4",bt("pop join replace reverse split push shift sort splice unshift".split(" "),function(t){var n=(/^(?:replace|split)$/.test(t)?String.prototype:ct)[t],e=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|join|replace|shift)$/.test(t);o.prototype[t]=function(){var t=arguments;if(r&&!this.__chain__){var i=this.value();return n.apply(Tt(i)?i:[],t)}return this[e](function(e){return n.apply(Tt(e)?e:[],t)})}}),o.prototype.toJSON=o.prototype.valueOf=o.prototype.value=function(){return S(this.__wrapped__,this.__actions__)},"function"==typeof define&&"object"==typeof define.amd&&define.amd?(ot._=o,define(function(){return o})):ut?((ut.exports=o)._=o,it._=o):ot._=o}).call(this),function(t){"use strict";if("function"==typeof bootstrap)bootstrap("promise",t);else if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=t}else{if("undefined"==typeof window&&"undefined"==typeof self)throw new Error("This environment was not anticipated by Q. Please file a bug.");var n="undefined"!=typeof window?window:self,e=n.Q;n.Q=t(),n.Q.noConflict=function(){return n.Q=e,this}}}(function(){"use strict";function t(t){return function(){return G.apply(t,arguments)}}function n(t){return t===Object(t)}function e(t){return"[object StopIteration]"===et(t)||t instanceof $}function r(t,n){if(B&&n.stack&&"object"==typeof t&&null!==t&&t.stack&&t.stack.indexOf(rt)===-1){for(var e=[],r=n;r;r=r.source)r.stack&&e.unshift(r.stack);e.unshift(t.stack);var o=e.join("\n"+rt+"\n");t.stack=i(o)}}function i(t){for(var n=t.split("\n"),e=[],r=0;r<n.length;++r){var i=n[r];a(i)||o(i)||!i||e.push(i)}return e.join("\n")}function o(t){return t.indexOf("(module.js:")!==-1||t.indexOf("(node.js:")!==-1}function u(t){var n=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(t);if(n)return[n[1],Number(n[2])];var e=/at ([^ ]+):(\d+):(?:\d+)$/.exec(t);if(e)return[e[1],Number(e[2])];var r=/.*@(.+):(\d+)$/.exec(t);return r?[r[1],Number(r[2])]:void 0}function a(t){var n=u(t);if(!n)return!1;var e=n[0],r=n[1];return e===U&&r>=Z&&r<=ct}function c(){if(B)try{throw new Error}catch(t){var n=t.stack.split("\n"),e=n[0].indexOf("@")>0?n[1]:n[2],r=u(e);if(!r)return;return U=r[0],r[1]}}function s(t,n,e){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(n+" is deprecated, use "+e+" instead.",new Error("").stack),t.apply(t,arguments)}}function f(t){return t instanceof d?t:_(t)?T(t):S(t)}function l(){function t(t){n=t,f.longStackSupport&&B&&(o.source=t),J(e,function(n,e){f.nextTick(function(){t.promiseDispatch.apply(t,e)})},void 0),e=void 0,r=void 0}var n,e=[],r=[],i=Y(l.prototype),o=Y(d.prototype);if(o.promiseDispatch=function(t,i,o){var u=H(arguments);e?(e.push(u),"when"===i&&o[1]&&r.push(o[1])):f.nextTick(function(){n.promiseDispatch.apply(n,u)})},o.valueOf=function(){if(e)return o;var t=y(n);return m(t)&&(n=t),t},o.inspect=function(){return n?n.inspect():{state:"pending"}},f.longStackSupport&&B)try{throw new Error}catch(u){o.stack=u.stack.substring(u.stack.indexOf("\n")+1)}return i.promise=o,i.resolve=function(e){n||t(f(e))},i.fulfill=function(e){n||t(S(e))},i.reject=function(e){n||t(E(e))},i.notify=function(t){n||J(r,function(n,e){f.nextTick(function(){e(t)})},void 0)},i}function p(t){if("function"!=typeof t)throw new TypeError("resolver must be a function.");var n=l();try{t(n.resolve,n.reject,n.notify)}catch(e){n.reject(e)}return n.promise}function h(t){return p(function(n,e){for(var r=0,i=t.length;r<i;r++)f(t[r]).then(n,e)})}function d(t,n,e){void 0===n&&(n=function(t){return E(new Error("Promise does not support operation: "+t))}),void 0===e&&(e=function(){return{state:"unknown"}});var r=Y(d.prototype);if(r.promiseDispatch=function(e,i,o){var u;try{u=t[i]?t[i].apply(r,o):n.call(r,i,o)}catch(a){u=E(a)}e&&e(u)},r.inspect=e,e){var i=e();"rejected"===i.state&&(r.exception=i.reason),r.valueOf=function(){var t=e();return"pending"===t.state||"rejected"===t.state?r:t.value}}return r}function v(t,n,e,r){return f(t).then(n,e,r)}function y(t){if(m(t)){var n=t.inspect();if("fulfilled"===n.state)return n.value}return t}function m(t){return t instanceof d}function _(t){return n(t)&&"function"==typeof t.then}function g(t){return m(t)&&"pending"===t.inspect().state}function b(t){return!m(t)||"fulfilled"===t.inspect().state}function w(t){return m(t)&&"rejected"===t.inspect().state}function k(){it.length=0,ot.length=0,at||(at=!0)}function j(t,n){at&&("object"==typeof process&&"function"==typeof process.emit&&f.nextTick.runAfter(function(){W(ot,t)!==-1&&(process.emit("unhandledRejection",n,t),ut.push(t))}),ot.push(t),n&&"undefined"!=typeof n.stack?it.push(n.stack):it.push("(no stack) "+n))}function x(t){if(at){var n=W(ot,t);n!==-1&&("object"==typeof process&&"function"==typeof process.emit&&f.nextTick.runAfter(function(){var e=W(ut,t);e!==-1&&(process.emit("rejectionHandled",it[n],t),ut.splice(e,1))}),ot.splice(n,1),it.splice(n,1))}}function E(t){var n=d({when:function(n){return n&&x(this),n?n(t):this}},function(){return this},function(){return{state:"rejected",reason:t}});return j(n,t),n}function S(t){return d({when:function(){return t},get:function(n){return t[n]},set:function(n,e){t[n]=e},"delete":function(n){delete t[n]},post:function(n,e){return null===n||void 0===n?t.apply(void 0,e):t[n].apply(t,e)},apply:function(n,e){return t.apply(n,e)},keys:function(){return nt(t)}},void 0,function(){return{state:"fulfilled",value:t}})}function T(t){var n=l();return f.nextTick(function(){try{t.then(n.resolve,n.reject,n.notify)}catch(e){n.reject(e)}}),n.promise}function O(t){return d({isDef:function(){}},function(n,e){return R(t,n,e)},function(){return f(t).inspect()})}function A(t,n,e){return f(t).spread(n,e)}function D(t){return function(){function n(t,n){var u;if("undefined"==typeof StopIteration){try{u=r[t](n)}catch(a){return E(a)}return u.done?f(u.value):v(u.value,i,o)}try{u=r[t](n)}catch(a){return e(a)?f(a.value):E(a)}return v(u,i,o)}var r=t.apply(this,arguments),i=n.bind(n,"next"),o=n.bind(n,"throw");return i()}}function C(t){f.done(f.async(t)())}function F(t){throw new $(t)}function P(t){return function(){return A([this,I(arguments)],function(n,e){return t.apply(n,e)})}}function R(t,n,e){return f(t).dispatch(n,e)}function I(t){return v(t,function(t){var n=0,e=l();return J(t,function(r,i,o){var u;m(i)&&"fulfilled"===(u=i.inspect()).state?t[o]=u.value:(++n,v(i,function(r){t[o]=r,0===--n&&e.resolve(t)},e.reject,function(t){e.notify({index:o,value:t})}))},void 0),0===n&&e.resolve(t),e.promise})}function M(t){if(0===t.length)return f.resolve();var n=f.defer(),e=0;return J(t,function(r,i,o){function u(t){n.resolve(t)}function a(t){e--,0===e&&(t.message="Q can't get fulfillment value from any promise, all promises were rejected. Last error message: "+t.message,n.reject(t))}function c(t){n.notify({index:o,value:t})}var s=t[o];e++,v(s,u,a,c)},void 0),n.promise}function N(t){return v(t,function(t){return t=X(t,f),v(I(X(t,function(t){return v(t,K,K)})),function(){return t})})}function Q(t){return f(t).allSettled()}function q(t,n){return f(t).then(void 0,void 0,n)}function L(t,n){return f(t).nodeify(n)}var B=!1;try{throw new Error}catch(z){B=!!z.stack}var U,$,Z=c(),K=function(){},V=function(){function t(){for(var t,r;e.next;)e=e.next,t=e.task,e.task=void 0,r=e.domain,r&&(e.domain=void 0,r.enter()),n(t,r);for(;a.length;)t=a.pop(),n(t);i=!1}function n(n,e){try{n()}catch(r){if(u)throw e&&e.exit(),setTimeout(t,0),e&&e.enter(),r;setTimeout(function(){throw r},0)}e&&e.exit()}var e={task:void 0,next:null},r=e,i=!1,o=void 0,u=!1,a=[];if(V=function(t){r=r.next={task:t,domain:u&&process.domain,next:null},i||(i=!0,o())},"object"==typeof process&&"[object process]"===process.toString()&&process.nextTick)u=!0,o=function(){process.nextTick(t)};else if("function"==typeof setImmediate)o="undefined"!=typeof window?setImmediate.bind(window,t):function(){setImmediate(t)};else if("undefined"!=typeof MessageChannel){var c=new MessageChannel;c.port1.onmessage=function(){o=s,c.port1.onmessage=t,t()};var s=function(){c.port2.postMessage(0)};o=function(){setTimeout(t,0),s()}}else o=function(){setTimeout(t,0)};return V.runAfter=function(t){a.push(t),i||(i=!0,o())},V}(),G=Function.call,H=t(Array.prototype.slice),J=t(Array.prototype.reduce||function(t,n){var e=0,r=this.length;if(1===arguments.length)for(;;){if(e in this){n=this[e++];break}if(++e>=r)throw new TypeError}for(;e<r;e++)e in this&&(n=t(n,this[e],e));return n}),W=t(Array.prototype.indexOf||function(t){for(var n=0;n<this.length;n++)if(this[n]===t)return n;return-1}),X=t(Array.prototype.map||function(t,n){var e=this,r=[];return J(e,function(i,o,u){r.push(t.call(n,o,u,e))},void 0),r}),Y=Object.create||function(t){function n(){}return n.prototype=t,new n},tt=t(Object.prototype.hasOwnProperty),nt=Object.keys||function(t){var n=[];for(var e in t)tt(t,e)&&n.push(e);return n},et=t(Object.prototype.toString);$="undefined"!=typeof ReturnValue?ReturnValue:function(t){this.value=t};var rt="From previous event:";f.resolve=f,f.nextTick=V,f.longStackSupport=!1,"object"==typeof process&&process&&process.env&&process.env.Q_DEBUG&&(f.longStackSupport=!0),f.defer=l,l.prototype.makeNodeResolver=function(){var t=this;return function(n,e){n?t.reject(n):arguments.length>2?t.resolve(H(arguments,1)):t.resolve(e)}},f.Promise=p,f.promise=p,p.race=h,p.all=I,p.reject=E,p.resolve=f,f.passByCopy=function(t){return t},d.prototype.passByCopy=function(){return this},f.join=function(t,n){return f(t).join(n)},d.prototype.join=function(t){return f([this,t]).spread(function(t,n){if(t===n)return t;throw new Error("Q can't join: not the same: "+t+" "+n)})},f.race=h,d.prototype.race=function(){return this.then(f.race)},f.makePromise=d,d.prototype.toString=function(){return"[object Promise]"},d.prototype.then=function(t,n,e){function i(n){try{return"function"==typeof t?t(n):n}catch(e){return E(e)}}function o(t){if("function"==typeof n){r(t,a);try{return n(t)}catch(e){return E(e)}}return E(t)}function u(t){return"function"==typeof e?e(t):t}var a=this,c=l(),s=!1;return f.nextTick(function(){a.promiseDispatch(function(t){s||(s=!0,c.resolve(i(t)))},"when",[function(t){s||(s=!0,c.resolve(o(t)))}])}),a.promiseDispatch(void 0,"when",[void 0,function(t){var n,e=!1;try{n=u(t)}catch(r){if(e=!0,!f.onerror)throw r;f.onerror(r)}e||c.notify(n)}]),c.promise},f.tap=function(t,n){return f(t).tap(n)},d.prototype.tap=function(t){return t=f(t),this.then(function(n){return t.fcall(n).thenResolve(n)})},f.when=v,d.prototype.thenResolve=function(t){return this.then(function(){return t})},f.thenResolve=function(t,n){return f(t).thenResolve(n)},d.prototype.thenReject=function(t){return this.then(function(){throw t})},f.thenReject=function(t,n){return f(t).thenReject(n)},f.nearer=y,f.isPromise=m,f.isPromiseAlike=_,f.isPending=g,d.prototype.isPending=function(){return"pending"===this.inspect().state},f.isFulfilled=b,d.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},f.isRejected=w,d.prototype.isRejected=function(){return"rejected"===this.inspect().state};var it=[],ot=[],ut=[],at=!0;f.resetUnhandledRejections=k,f.getUnhandledReasons=function(){return it.slice()},f.stopUnhandledRejectionTracking=function(){k(),at=!1},k(),f.reject=E,f.fulfill=S,f.master=O,f.spread=A,d.prototype.spread=function(t,n){return this.all().then(function(n){return t.apply(void 0,n)},n)},f.async=D,f.spawn=C,f["return"]=F,f.promised=P,f.dispatch=R,d.prototype.dispatch=function(t,n){var e=this,r=l();return f.nextTick(function(){e.promiseDispatch(r.resolve,t,n)}),r.promise},f.get=function(t,n){return f(t).dispatch("get",[n])},d.prototype.get=function(t){return this.dispatch("get",[t])},f.set=function(t,n,e){return f(t).dispatch("set",[n,e])},d.prototype.set=function(t,n){return this.dispatch("set",[t,n])},f.del=f["delete"]=function(t,n){return f(t).dispatch("delete",[n])},d.prototype.del=d.prototype["delete"]=function(t){return this.dispatch("delete",[t])},f.mapply=f.post=function(t,n,e){return f(t).dispatch("post",[n,e])},d.prototype.mapply=d.prototype.post=function(t,n){return this.dispatch("post",[t,n])},f.send=f.mcall=f.invoke=function(t,n){return f(t).dispatch("post",[n,H(arguments,2)])},d.prototype.send=d.prototype.mcall=d.prototype.invoke=function(t){return this.dispatch("post",[t,H(arguments,1)])},f.fapply=function(t,n){return f(t).dispatch("apply",[void 0,n])},d.prototype.fapply=function(t){return this.dispatch("apply",[void 0,t])},f["try"]=f.fcall=function(t){return f(t).dispatch("apply",[void 0,H(arguments,1)])},d.prototype.fcall=function(){return this.dispatch("apply",[void 0,H(arguments)])},f.fbind=function(t){var n=f(t),e=H(arguments,1);return function(){return n.dispatch("apply",[this,e.concat(H(arguments))])}},d.prototype.fbind=function(){var t=this,n=H(arguments);return function(){return t.dispatch("apply",[this,n.concat(H(arguments))])}},f.keys=function(t){return f(t).dispatch("keys",[])},d.prototype.keys=function(){return this.dispatch("keys",[])},f.all=I,d.prototype.all=function(){return I(this)},f.any=M,d.prototype.any=function(){return M(this)},f.allResolved=s(N,"allResolved","allSettled"),d.prototype.allResolved=function(){return N(this)},f.allSettled=Q,d.prototype.allSettled=function(){return this.then(function(t){return I(X(t,function(t){function n(){return t.inspect()}return t=f(t),t.then(n,n)}))})},f.fail=f["catch"]=function(t,n){return f(t).then(void 0,n)},d.prototype.fail=d.prototype["catch"]=function(t){return this.then(void 0,t)},f.progress=q,d.prototype.progress=function(t){return this.then(void 0,void 0,t)},f.fin=f["finally"]=function(t,n){return f(t)["finally"](n)},d.prototype.fin=d.prototype["finally"]=function(t){if(!t||"function"!=typeof t.apply)throw new Error("Q can't apply finally callback");return t=f(t),this.then(function(n){return t.fcall().then(function(){return n})},function(n){return t.fcall().then(function(){throw n})})},f.done=function(t,n,e,r){return f(t).done(n,e,r)},d.prototype.done=function(t,n,e){var i=function(t){f.nextTick(function(){if(r(t,o),!f.onerror)throw t;f.onerror(t)})},o=t||n||e?this.then(t,n,e):this;"object"==typeof process&&process&&process.domain&&(i=process.domain.bind(i)),o.then(void 0,i)},f.timeout=function(t,n,e){return f(t).timeout(n,e)},d.prototype.timeout=function(t,n){var e=l(),r=setTimeout(function(){n&&"string"!=typeof n||(n=new Error(n||"Timed out after "+t+" ms"),n.code="ETIMEDOUT"),e.reject(n)},t);return this.then(function(t){clearTimeout(r),e.resolve(t)},function(t){clearTimeout(r),e.reject(t)},e.notify),e.promise},f.delay=function(t,n){return void 0===n&&(n=t,t=void 0),f(t).delay(n)},d.prototype.delay=function(t){return this.then(function(n){var e=l();return setTimeout(function(){e.resolve(n)},t),e.promise})},f.nfapply=function(t,n){return f(t).nfapply(n)},d.prototype.nfapply=function(t){var n=l(),e=H(t);return e.push(n.makeNodeResolver()),this.fapply(e).fail(n.reject),n.promise},f.nfcall=function(t){var n=H(arguments,1);return f(t).nfapply(n)},d.prototype.nfcall=function(){var t=H(arguments),n=l();return t.push(n.makeNodeResolver()),this.fapply(t).fail(n.reject),n.promise},f.nfbind=f.denodeify=function(t){if(void 0===t)throw new Error("Q can't wrap an undefined function");var n=H(arguments,1);return function(){var e=n.concat(H(arguments)),r=l();return e.push(r.makeNodeResolver()),f(t).fapply(e).fail(r.reject),r.promise}},d.prototype.nfbind=d.prototype.denodeify=function(){var t=H(arguments);return t.unshift(this),f.denodeify.apply(void 0,t)},f.nbind=function(t,n){var e=H(arguments,2);return function(){function r(){return t.apply(n,arguments)}var i=e.concat(H(arguments)),o=l();return i.push(o.makeNodeResolver()),f(r).fapply(i).fail(o.reject),o.promise}},d.prototype.nbind=function(){var t=H(arguments,0);return t.unshift(this),f.nbind.apply(void 0,t)},f.nmapply=f.npost=function(t,n,e){return f(t).npost(n,e)},d.prototype.nmapply=d.prototype.npost=function(t,n){var e=H(n||[]),r=l();return e.push(r.makeNodeResolver()),this.dispatch("post",[t,e]).fail(r.reject),r.promise},f.nsend=f.nmcall=f.ninvoke=function(t,n){var e=H(arguments,2),r=l();return e.push(r.makeNodeResolver()),f(t).dispatch("post",[n,e]).fail(r.reject),r.promise},d.prototype.nsend=d.prototype.nmcall=d.prototype.ninvoke=function(t){var n=H(arguments,1),e=l();return n.push(e.makeNodeResolver()),this.dispatch("post",[t,n]).fail(e.reject),e.promise},f.nodeify=L,d.prototype.nodeify=function(t){return t?void this.then(function(n){f.nextTick(function(){t(null,n)})},function(n){f.nextTick(function(){t(n)})}):this},f.noConflict=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var ct=c();return f}),function(){function t(n,e,r){function i(u,a){if(!e[u]){if(!n[u]){var c="function"==typeof require&&require;if(!a&&c)return c(u,!0);if(o)return o(u,!0);var s=new Error("Cannot find module '"+u+"'");throw s.code="MODULE_NOT_FOUND",s}var f=e[u]={exports:{}};n[u][0].call(f.exports,function(t){var e=n[u][1][t];return i(e?e:t)},f,f.exports,t,n,e,r)}return e[u].exports}for(var o="function"==typeof require&&require,u=0;u<r.length;u++)i(r[u]);return i}return t}()({1:[function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}var i=(t("./core/Polyfill"),t("./core/Core")),o=r(i);!function(){o["default"]._exposeTo(window),window.SB=o["default"]}()},{"./core/Core":2,"./core/Polyfill":6}],2:[function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),u=t("./Dataset"),a=r(u),c=t("./Timeline"),s=r(c),f=t("./DataSource"),l=r(f),p=t("./Environment"),h=r(p),d=t("../tool/QueryString"),v=r(d),y=t("../tool/Util.js"),m=r(y),_="local",g="switchboard",b="old_switchboard",w="undefined"==typeof window.Switchboard?"undefined"==typeof window.data?_:b:g;w!==_&&w!==b||(window.Switchboard={});var k={data:!1,env:!1,init:!1},j=0,x=[],E=[],S=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),n.offset=n.offset||v["default"].get("localOffset"),n.debug&&(j++,n.debug=j),this.Timeline=new s["default"](n)}return o(t,[{key:"timeline",get:function(){return this.Timeline}}],[{key:"setup",value:function(n){if(k.data&&k.env)return n.success&&n.success(),Q.when();var e=Q.defer();if(x.push(e),n.success&&E.push(n.success),!k.init){k.init=!0;var r=function(){E.forEach(function(t){return t()}),E=[],x.forEach(function(t){t.resolve()}),x=[]},i={url:n.url||null,location:n.location||n.dataSourceLocation||null,sources:n.sources||null,success:function(){console.log("Datasources loaded."),k.data=!0,k.env&&r()}};n.env=n.env||{};var o={url:n.url||null,location:n.location||n.environmentLocation||null,content:n.content||m["default"].contentName,channelScreenId:n.channelScreenId,screenId:n.screenId,orientation:n.orientation,success:function(){console.log("Environment loaded."),k.env=!0,k.data&&r()}};t.Data.load(i),t.Env.load(o)}return e.promise}},{key:"Dataset",value:function(t){return new a["default"](t)}},{key:"_exposeTo",value:function(n){n._sb={},n._sb._dataset=t.Dataset,n._sb._timeline=s["default"],n._sb._dataSource=l["default"],n._sb._environment=h["default"],n._sb._dataSourceInstance=t.Data,n._sb._environmentInstance=t.Env,n._sb._tool={},n._sb._tool._queryString=t.QueryString,n._sb._reset=function(){k={data:!1,env:!1,init:!1},j=0,x=[],E=[]}}},{key:"local",get:function(){return w===_}},{key:"compatability",get:function(){return w===b}},{key:"Data",get:function(){return new l["default"](this)}},{key:"Env",get:function(){return new h["default"](this)}},{key:"Timeline",get:function(){return s["default"]}},{key:"QueryString",get:function(){return v["default"]}}]),t}();e["default"]=S},{"../tool/QueryString":9,"../tool/Util.js":10,"./DataSource":3,"./Dataset":4,"./Environment":5,"./Timeline":7}],3:[function(t,n,e){"use strict";function r(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),o=null,u="window.SB.Data",a=function(){
function t(n){return r(this,t),o||(this._core=n,this._sources=[],this._completeCallback=null,this._jsonpCallbacks={i:0},this._global=u,this.base="",this.location="",o=this),o}return i(t,[{key:"load",value:function(t){var n=this;this._completeCallback=t.success||function(){},this.base=t.url||"",this.location=t.location||"",this._sources=t.sources||[],this._core.local&&this._sources.length>0?(window.Switchboard.dataSources={},this._sources.map(function(t){var e="string"==typeof t?t:t.filename,r="undefined"!=typeof t.name?t.name:e,i=n._toAPIFormat(n.base,n.location)+e+".jsonp",o="fn"+n._jsonpCallbacks.i++;n._jsonpCallbacks[o]=function(t,e){var r=n;return function(){delete r._jsonpCallbacks[e];var n=Array.prototype.slice.call(arguments);n.unshift(t),r._complete.apply(r,n)}}(r,o),n._jsonp(i,o)})):(this._core.compatability&&(window.Switchboard.dataSources=window.data),this._completeCallback())}},{key:"fetch",value:function(t,n,e){var r=this,i=n||t;if(this.has(i)&&!e)return Q.when(this.get(i));var o=Q.defer(),u=this._toAPIFormat(this.base,this.location)+i+".jsonp",a="fn"+this._jsonpCallbacks.i++;return this._jsonpCallbacks[a]=function(t,n,e){var i=r;return function(){delete i._jsonpCallbacks[n];var r=Array.prototype.slice.call(arguments);r.unshift(t);var u=r[0],a=r[1];window.Switchboard.dataSources[u]=a,i._sources.push({name:u,filename:e}),o.resolve(a)}}(i,a),this._jsonp(u,a),o.promise}},{key:"fetchAll",value:function(t){var n=this,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=[];return t.forEach(function(t){t="string"==typeof s?{filename:t}:t,r.push(n.fetch(t.filename,t.name,e))}),Q.all(r)}},{key:"get",value:function(t){if(this._assignMeta(),"undefined"==typeof t){var n=this._toArray(window.Switchboard.dataSources);return"undefined"==typeof n&&(n={}),this._addMethods(n)}if("undefined"!=typeof window.Switchboard.dataSources[t])return this._toArray(window.Switchboard.dataSources[t]);for(var e=0;e<this._sources.length;e++){var r=this._sources[e];if("string"!=typeof r&&t==r.name&&"undefined"!=typeof window.Switchboard.dataSources[r.filename])return this._toArray(window.Switchboard.dataSources[r.filename])}throw new Error('DataSource "'+t+'" does not exist in Switchboard.dataSource')}},{key:"like",value:function(t){return this.get().like(t)}},{key:"set",value:function(t,n){if("undefined"==typeof window.Switchboard.dataSources[t])for(var e=0;e<this._sources.length;e++){var r=this._sources[e];"string"!=typeof r&&t==r.name&&"undefined"!=typeof window.Switchboard.dataSources[r.filename]&&(t=r.filename)}window.Switchboard.dataSources[t]=n}},{key:"has",value:function(t){try{this.get(t)}catch(n){return!1}return!0}},{key:"_like",value:function(t,n){var e={};for(var r in n)r.toLowerCase().indexOf(".csv")>0&&r.toLowerCase().indexOf(t.toLowerCase())>=0&&(e[r]=n[r]);return this._addMethods(e)}},{key:"_scheduled",value:function(t){var n=6e4*(new Date).getTimezoneOffset(),e=Date.now(),r=null,i=null,o=/\d{8}(T\d{6}Z*)*(\.csv)/g;for(var u in t)if(u.match(o)){var a=u.match(o)[0].replace(".csv",""),c=a.substring(0,4)+"-"+a.substring(4,6)+"-"+a.substring(6,8);a.indexOf("T")>0?(c+=a.substring(8,11)+":"+a.substring(11,13)+":"+a.substring(13),a.indexOf("Z")<0&&(c+="Z")):c+="T00:00:00Z";var s=new Date(c).getTime()+n;s<=e&&(null==r||r<s)&&(r=s,i=u)}return i?t[i]:t.single()}},{key:"single",value:function(){return this.get().single()}},{key:"_single",value:function(){for(var t in this)if(t.toLowerCase().indexOf(".csv")>0)return this[t];return null}},{key:"_complete",value:function(t,n){window.Switchboard.dataSources[t]=n;for(var e=!0,r=0;r<this._sources.length;r++){var i=this._sources[r],o="string"==typeof i?i:i.filename,u="undefined"!=typeof i.name?i.name:o;"undefined"==typeof window.Switchboard.dataSources[u]&&(e=!1)}e&&this._completeCallback()}},{key:"_toAPIFormat",value:function(t,n){if(n&&("/"!=t[t.length-1]&&(t+="/"),t+="local/"+n+"/"),t.indexOf("/api/dataSource/")<0)return"/"!=t[t.length-1]&&(t+="/"),t+"api/dataSource/"}},{key:"_toScriptTag",value:function(t,n){var e=document.createElement("script");return e.src=t+"?callback="+u+"._jsonpCallbacks."+n,e.dataset.switchboard=!0,e}},{key:"_jsonp",value:function(t,n){document.body.appendChild(this._toScriptTag(t,n))}},{key:"_toArray",value:function(t){return t instanceof Array?Array.from(t):t}},{key:"_addMethods",value:function(t){var n=this;return t.like=function(e){return n._like(e,t)},t.scheduled=function(){return n._scheduled(t)},t.single=this._single,t}},{key:"_assignMeta",value:function(){for(var t in window.Switchboard.dataSources){for(var n=t,e=0;e<this._sources.length;e++){var r=this._sources[e],i="string"==typeof r?r:r.filename,o="undefined"!=typeof r.name?r.name:i;t===o&&(n=i)}window.Switchboard.dataSources[t].meta={name:t,filename:n}}}}],[{key:"instance",value:function(){return new t}}]),t}();e["default"]=a},{}],4:[function(t,n,e){"use strict";function r(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),o=function(){function t(n){r(this,t),Array.isArray(n)||(n=[n]),this._primary=n,this._stack=[],this._callstack=[]}return i(t,[{key:"where",value:function(t,n,e){var r=[],i={"=":function(t,n){return t==n},"!=":function(t,n){return t!=n},"<=":function(t,n){return t<=n},"<":function(t,n){return t<n},">=":function(t,n){return t>=n},">":function(t,n){return t>n}};if("undefined"==typeof i[n])throw new Error("Invalid operator ("+n+")");return this.get().map(function(o){i[n](o[t],e)&&r.push(o)}),r}},{key:"join",value:function(t,n){return this._join(t,n,"one")}},{key:"joinMany",value:function(t,n){if(2!=arguments.length)throw new Error("JoinMany requires a name to be provided");return this._join(t,n,"many")}},{key:"_join",value:function(t,n,e){if("join"==this._callstack[this._callstack.length-1])throw new Error("On must be called before performing another join.");return this._stack.push({name:n,dataset:t,key:null,foreignKey:null,type:e}),this._callstack.push("join"),this}},{key:"on",value:function(t,n){1==arguments.length&&(n=t);var e=this._stack.pop();return e.key=t,e.foreignKey=n,this._stack.push(e),this._callstack.push("on"),this}},{key:"get",value:function(){var t=this;this._callstack=[],this._stack.reverse();for(var n=function(){var n=t._stack.pop();t._primary.map(function(t){for(var e=[],r=0;r<n.dataset.length;r++){var i=n.dataset[r];t[n.key]==i[n.foreignKey]&&e.push(i)}if("one"==n.type){e=e[0],n.name&&(t[n.name]={});for(var o in e)n.name?t[n.name][o]=e[o]:t[o]=e[o]}"many"==n.type&&(t[n.name]=e)})};this._stack.length>0;)n();return this._primary}}]),t}();e["default"]=o},{}],5:[function(t,n,e){"use strict";function r(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),o=null,u="window.SB.Env",a=function(){function t(n){return r(this,t),o||(this._core=n,o=this),o}return i(t,[{key:"load",value:function(t){this._completeCallback=t.success||function(){};var n=t.url||"",e=t.location||"",r=t.orientation||"",i=t.channelScreenId||null,o=t.screenId||null,u=t.content||"";if(this._sources=t.sources||[],this._core.local&&""!=e&&""==u&&console.warn("Location provided to environment but no content provided."),this._core.local&&""!=u){window.Switchboard.environmentData={};var a=void 0,c={locationCode:e,orientation:r,channelScreenId:i,screenId:o},s=[];Object.keys(c).forEach(function(t){c[t]&&s.push(t+"="+c[t])}),a=s.length>0?"?"+s.join("&"):"";var f=this._toAPIFormat(n,e)+u+".jsonp/"+a;this._jsonp(f)}else this._core.compatability&&(window.Switchboard.environmentData=window.meta),this._completeCallback()}},{key:"get",value:function(t){if("undefined"!=typeof window.Switchboard.environmentData[t])return window.Switchboard.environmentData[t];if("undefined"==typeof t)return window.Switchboard.environmentData;throw new Error("Environment Data does not exist in SB.Env")}},{key:"has",value:function(t){try{this.get(t)}catch(n){return!1}return!0}},{key:"_complete",value:function(t){window.Switchboard.environmentData=t,this._completeCallback()}},{key:"_toAPIFormat",value:function(t,n,e,r,i){if(t.indexOf("/api/environmentData/")<0)return"/"!=t[t.length-1]&&(t+="/"),t+"api/environmentData/"}},{key:"_toScriptTag",value:function(t,n){var e=document.createElement("script"),r=t.indexOf("?")>0?"&":"?";return e.src=""+t+r+"callback="+u+"._complete",e.dataset.switchboard=!0,e.dataset.switchboardenv=!0,e}},{key:"_jsonp",value:function(t,n){document.body.appendChild(this._toScriptTag(t))}},{key:"location",get:function(){return{id:this.get("location"),name:this.get("location-name"),label:this.get("location-label"),timezone:this.get("location-timezone"),groups:this.get("location-groups")}}},{key:"orientation",get:function(){return"normal"!==this.get("orientation").toLowerCase()?"vertical":"horizontal"}},{key:"sequence",get:function(){return parseInt(this.get("sequence"))}},{key:"content",get:function(){return{name:this.get("content-name"),label:this.get("content-label"),modified:this.get("content-modified"),groups:this.get("content-groups")}}},{key:"channel",get:function(){return{name:this.get("channel-name"),screen:this.get("channel-screen"),screens:this.get("channel-screens"),groups:this.get("channel-groups")}}}],[{key:"instance",value:function(){return new t}}]),t}();e["default"]=a},{}],6:[function(t,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Array.from||(Array.from=function(t){return[].slice.call(t)}),function(){for(var t=0,n=["webkit","moz"],e=0;e<n.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[n[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[n[e]+"CancelAnimationFrame"]||window[n[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n,e){var r=(new Date).getTime(),i=Math.max(0,16-(r-t)),o=window.setTimeout(function(){n(r+i)},i);return t=r+i,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),e.Array=Array},{}],7:[function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?t:n}function o(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}function u(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),c=t("../debug/TimelineDebug"),s=r(c),f=(t("./Polyfill"),10),l=0,p=function(){function t(){var n=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u(this,t),this._drawDebug=e.debug||!1,this._timelineDebug=new s["default"](this._drawDebug),this._framerate=e.framerate||f,this._cycleTime=e.cycleTime||l,this._offset=e.offset||0,this._timelineEvents={},this._fixedEvents=[],this._intervalEvents=[],this._previous=0,this._currentlyExecuting=null,this._frameLength=Math.floor(1e3/this._framerate),window.requestAnimationFrame(function(){n._update()})}return a(t,[{key:"addEvent",value:function(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments[3];return null==e?this._addFixedEvent(t,n,r):this._addIntervalEvent(t,n,e,r)}},{key:"triggerLatest",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;for(null==t&&(t=this._cyclePosition);t>=0;)this._timelineEvents[t]&&(this._timelineEvents[t].forEach(function(n){return n.trigger(t)}),t=0),t-=this._frameLength}},{key:"clear",value:function(){this._timelineEvents={}}},{key:"cleanUp",value:function(){}},{key:"reset",value:function(){this._offset=-Date.now()}},{key:"_update",value:function(){var t=this,n=this._cyclePosition;if(0!=this._cycleTime){if(n!=this._currentExecuting){this._currentExecuting=n;for(var e=this._previous,r=e;r<n;r++)this._timelineEvents[r]&&this._timelineEvents[r].forEach(function(t){return t.trigger(n)});this._previous=this._currentExecuting,this._timelineDebug.update(n,this._cycleTime,this._timelineEvents)}window.requestAnimationFrame(function(){t._update()})}}},{key:"_addFixedEvent",value:function(t,n,e){var r=new d(t,this._toFrameTime(n),e);return this._fixedEvents.push(r),this._generate(),r}},{key:"_addIntervalEvent",value:function(t,n,e,r){var i=new v(t,this._toFrameTime(n),this._toFrameTime(e),r);return this._intervalEvents.push(i),this._generate(),i}},{key:"_generate",value:function(){var t=this;0!=this._cycleTime&&(this.clear(),this._fixedEvents.forEach(function(n){t._insertEvent(n.time,n)}),this._intervalEvents.forEach(function(n){for(var e=n.time;e<t._cycleTime;)t._insertEvent(e,n),e+=n.interval}))}},{key:"_insertEvent",value:function(t,n){"undefined"==typeof this._timelineEvents[t]&&(this._timelineEvents[t]=[]),this._timelineEvents[t].push(n)}},{key:"_toFrameTime",value:function(t){return Math.floor(t/this._frameLength)*this._frameLength}},{key:"cycleTime",set:function(t){this._cycleTime=t,this._generate()}},{key:"_cyclePosition",get:function(){var t=Date.now();return t+=this._offset,this._toFrameTime(t%this._cycleTime)}}]),t}(),h=function(){function t(n,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";u(this,t),this._callback=n,this._time=e,this._tag=r}return a(t,[{key:"trigger",value:function(t){this._callback(t)}},{key:"time",get:function(){return this._time}},{key:"tag",get:function(){return this._tag}}]),t}(),d=function(t){function n(t,e,r){return u(this,n),i(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e,r))}return o(n,t),n}(h),v=function(t){function n(t,e,r,o){u(this,n);var a=i(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e,o));return a._interval=r,a}return o(n,t),a(n,[{key:"interval",get:function(){return this._interval}}]),n}(h);e["default"]=p},{"../debug/TimelineDebug":8,"./Polyfill":6}],8:[function(t,n,e){"use strict";function r(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),o={canvas:{position:"absolute",bottom:"0",left:"0",background:"#000","border-top":"#f8f8f8 1px solid"}},u=30,a=2,c=4,s=.5,f=.3333333,l={unprogress:"#333",progress:"#666",eventFixed:"rgba(255,178,102,1)",eventInterval:"rgba(102,204,255,1)",eventFixedDone:"rgba(225,148,72,1)",eventIntervalDone:"rgba(72,174,225,1)",eventTag:"#fff",text:"#FFFFFF"},p=function(){function t(){var n=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(r(this,t),this._debug=e,this._frame=0,this._cycle=0,this._events=[],this._mouse={x:0,y:0},this._tag="",this._debug){this._canvas=document.createElement("canvas"),this._canvas.id="sb-timeline-debug";for(var i in o.canvas)this._canvas.style[i]=o.canvas[i];this._canvas.style.bottom=10*(this._debug-1)+"%",this._ctx=this._canvas.getContext("2d"),document.body.appendChild(this._canvas),window.addEventListener("resize",function(){n.update(n._frame,n._cycle,n._events)}),this._resizeCanvas(),this._ctx.font="20px Arial",this._ctx.textAlign="center",this._ctx.fillStyle=l.text,this._ctx.fillText("Timeline Inactive",this._canvas.width/2,this._canvas.height/2),window.addEventListener("mousemove",function(t){n._setMouse(t)})}}return i(t,[{key:"update",value:function(t,n,e){if(this._frame=t,this._cycle=n,this._events=e,this._debug){var r=this._canvas,i=this._ctx;this._resizeCanvas();var o=r.width-2*u;i.clearRect(0,0,r.width,r.height);var p=a,h=c,d=0;n&&(d=Math.floor(t/n*o/(p+h))*(p+h));for(var v=0;v<o;v+=p+h)i.fillStyle=l.unprogress,v<d&&(i.fillStyle=l.progress),i.fillRect(v+u,r.height*s,h,r.height*f);this._eventTag="";for(var y in e)for(var m=0;m<e[y].length;m++){var _=e[y][m];this._drawEvent(d,n,y,_,e[y])}this._drawEventTag(this._eventTag,u,u),i.fillStyle="#000",i.fillRect(0,r.height*(s+.5*f),r.width,1)}}},{key:"_drawEvent",value:function(t,n,e,r,i){var o=this._canvas,p=this._ctx,h=o.width-2*u,d=a,v=c,y=this._isFixed(r),m=l.eventFixed,_=l.eventFixedDone,g=o.height*f*.5,b=g;y||(m=l.eventInterval,_=l.eventIntervalDone,g=0,b=o.height*f*.5);var w={x:Math.floor(e/n*h/(d+v))*(d+v)+u,y:o.height*s+g};p.fillStyle=m,w<t&&(p.fillStyle=_),p.fillRect(w.x,w.y,v,b);this._isOver(w.x,w.y,v,b)&&this._addEventTag((r.tag||"[No Tag]")+" "+(e/1e3).toFixed(3)+"s")}},{key:"_addEventTag",value:function(t){""!=this._eventTag&&(this._eventTag+=", "),this._eventTag+=t}},{key:"_drawEventTag",value:function(t,n,e){this._ctx.textAlign="left",this._ctx.font="20px Arial",this._ctx.fillStyle=l.eventTag,this._ctx.fillText(t,n,e)}},{key:"_resizeCanvas",value:function(){this._canvas.width=window.innerWidth,this._canvas.height=.1*window.innerHeight}},{key:"_isFixed",value:function(t){return"undefined"==typeof t.interval}},{key:"_isOver",value:function(t,n,e,r){var i=this._mouse,o=4;return t-=o,n-=o,e+=2*o,r+=2*o,t<i.x&&t+e>i.x&&n<i.y&&n+r>i.y}},{key:"_setMouse",value:function(t){var n=this._canvas.getBoundingClientRect();this._mouse={x:t.clientX-n.left,y:t.clientY-n.top}}}]),t}();e["default"]=p},{}],9:[function(t,n,e){"use strict";function r(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),o=function(){function t(){r(this,t)}return i(t,null,[{key:"get",value:function(t){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location.search,e=n.substring(1),r=e.split("&"),i=0;i<r.length;i++){var o=r[i].split("=");if(o[0]==t)return o[1]}return null}}]),t}();e["default"]=o},{}],10:[function(t,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={get contentName(){return delete this.contentName,this.contentName=_.find(window.location.href.split("/"),function(t){return t.indexOf(".zip")!==-1}).replace("%20"," ")}};e["default"]=r},{}]},{},[1]);